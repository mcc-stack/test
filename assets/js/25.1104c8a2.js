(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{431:function(v,_,t){"use strict";t.r(_);var a=t(42),i=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"秒杀项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#秒杀项目"}},[v._v("#")]),v._v(" 秒杀项目")]),v._v(" "),t("h2",{attrs:{id:"做了什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#做了什么"}},[v._v("#")]),v._v(" 做了什么")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("完成基本下单流程逻辑和页面；")])]),v._v(" "),t("li",[t("p",[v._v("优化表结构，加入辅助索引，加快减库存执行；")])]),v._v(" "),t("li",[t("p",[v._v("缓存商品库存，在下单时使用 RocketMQ 异步同步数据库；")])]),v._v(" "),t("li",[t("p",[v._v("引入库存流水，使用 RokcetMQ 事务保证事务一致性；")]),v._v(" "),t("p",[v._v("引入库存流水是为了保证下单失败时，可以正确地回补库存。")])]),v._v(" "),t("li",[t("p",[v._v("加入秒杀令牌，秒杀大闸，实现流量削峰；")])]),v._v(" "),t("li",[t("p",[v._v("创建线程池，实现具有拥塞窗口的等待队列，完成队列泄洪；")])]),v._v(" "),t("li",[t("p",[v._v("引入验证码，实现错峰，同时使用 RateLimiter 实现令牌桶算法；")])]),v._v(" "),t("li",[t("p",[v._v("使用 Nginx 完成动静分离，负载均衡和反向代理，并优化了 Nginx 的短连接，使之提供长连接；")])]),v._v(" "),t("li",[t("p",[v._v("使用 Nginx+lua+redis 完成缓存处理；")])]),v._v(" "),t("li",[t("p",[v._v("在本地使用 Jmeter 进行压测。")])])]),v._v(" "),t("h2",{attrs:{id:"优化方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优化方案"}},[v._v("#")]),v._v(" 优化方案")]),v._v(" "),t("ol",[t("li",[v._v("redis 可以做成集群，提高项目的高可用性；")]),v._v(" "),t("li",[v._v("可以将项目扩展成 dubbo，做一个分布式；")]),v._v(" "),t("li",[v._v("验证码可以使用手机的短信验证模式。")])]),v._v(" "),t("h2",{attrs:{id:"提问"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#提问"}},[v._v("#")]),v._v(" 提问")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("讲一下库存缓存的设计思想？")]),v._v(" "),t("p",[v._v("下单时，先去查 redis 缓存，如果有多的话异步消息扣减库存，生成订单。")])]),v._v(" "),t("li",[t("p",[v._v("为什么要引入消息队列的事务？")]),v._v(" "),t("p",[v._v("如果减库存成功，但是生成订单以及后续操作产生了异常，就没有办法进行库存的回补，会出现少卖的现象，即库存在不知不觉中被扣减了。")]),v._v(" "),t("p",[v._v("所以需要当消息成功发出，同时订单生成成功；订单生成失败，消息立马回滚。")])]),v._v(" "),t("li",[t("p",[v._v("lua 有什么优势嘛？")]),v._v(" "),t("p",[v._v("它和 Nginx 一样都是使用的协程机制，可以很好的拟合，我们可以同步编写代码，当遇到阻塞，会自动异步执行，同时它也是基于内存的，开销小。")])])]),v._v(" "),t("h2",{attrs:{id:"微信小程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#微信小程序"}},[v._v("#")]),v._v(" 微信小程序")]),v._v(" "),t("h2",{attrs:{id:"做了什么-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#做了什么-2"}},[v._v("#")]),v._v(" 做了什么")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("对文章、评论等模块的增删改查；")])]),v._v(" "),t("li",[t("p",[v._v("基于百度 AI 的内容审核，完成用户内容过滤；")])]),v._v(" "),t("li",[t("p",[v._v("使用 redis 对用户投票做缓存处理。")])])]),v._v(" "),t("h2",{attrs:{id:"优化方案-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优化方案-2"}},[v._v("#")]),v._v(" 优化方案")]),v._v(" "),t("ol",[t("li",[v._v("我们是有个消息功能的，之后可以使用 WebSocket 进行推送；")]),v._v(" "),t("li",[v._v("可以对用户进行聚类，做定向的文章推送。")]),v._v(" "),t("li",[v._v("投票可以加上消息队列进行削峰填谷。")])])])}),[],!1,null,null,null);_.default=i.exports}}]);